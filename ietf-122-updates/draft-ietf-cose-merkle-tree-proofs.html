<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>COSE Receipts</title>
<meta content="Orie Steele" name="author">
<meta content="Henk Birkholz" name="author">
<meta content="Antoine Delignat-Lavaud" name="author">
<meta content="Cedric Fournet" name="author">
<meta content="
       COSE (CBOR Object Signing and Encryption) Receipts prove properties of a verifiable data structure to a verifier.
Verifiable data structures and associated proof types enable security properties, such as minimal disclosure, transparency and non-equivocation.
Transparency helps maintain trust over time, and has been applied to certificates, end to end encrypted messaging systems, and supply chain security.
This specification enables concise transparency oriented systems, by building on CBOR (Concise Binary Object Representation) and COSE.
The extensibility of the approach is demonstrated by providing CBOR encodings for RFC9162. 
    " name="description">
<meta content="xml2rfc 3.28.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-cose-merkle-tree-proofs-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.28.0
    Python 3.12.9
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.5
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-cose-merkle-tree-proofs.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">COSE Receipts</td>
<td class="right">March 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Steele, et al.</td>
<td class="center">Expires 17 September 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">COSE</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-cose-merkle-tree-proofs-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-03-16" class="published">16 March 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-09-17">17 September 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">O. Steele</div>
<div class="org">Transmute</div>
</div>
<div class="author">
      <div class="author-name">H. Birkholz</div>
<div class="org">Fraunhofer SIT</div>
</div>
<div class="author">
      <div class="author-name">A. Delignat-Lavaud</div>
<div class="org">Microsoft</div>
</div>
<div class="author">
      <div class="author-name">C. Fournet</div>
<div class="org">Microsoft</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">COSE Receipts</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">COSE (CBOR Object Signing and Encryption) Receipts prove properties of a verifiable data structure to a verifier.
Verifiable data structures and associated proof types enable security properties, such as minimal disclosure, transparency and non-equivocation.
Transparency helps maintain trust over time, and has been applied to certificates, end to end encrypted messaging systems, and supply chain security.
This specification enables concise transparency oriented systems, by building on CBOR (Concise Binary Object Representation) and COSE.
The extensibility of the approach is demonstrated by providing CBOR encodings for RFC9162.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
    CBOR Object Signing and Encryption Working Group mailing list (cose@ietf.org),
    which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/cose/">https://mailarchive.ietf.org/arch/browse/cose/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/cose-wg/draft-ietf-cose-merkle-tree-proofs">https://github.com/cose-wg/draft-ietf-cose-merkle-tree-proofs</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 17 September 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-requirements-notation" class="internal xref">Requirements Notation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-new-cose-header-parameters" class="internal xref">New COSE Header Parameters</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-verifiable-data-structures-" class="internal xref">Verifiable Data Structures in CBOR</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-structures" class="internal xref">Structures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-parameters" class="internal xref">Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-usage" class="internal xref">Usage</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="auto internal xref">4.3.1</a>.  <a href="#name-registration-requirements" class="internal xref">Registration Requirements</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-rfc9162_sha256" class="internal xref">RFC9162_SHA256</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-verifiable-data-structure" class="internal xref">Verifiable Data Structure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-inclusion-proof" class="internal xref">Inclusion Proof</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-receipt-of-inclusion" class="internal xref">Receipt of Inclusion</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-consistency-proof" class="internal xref">Consistency Proof</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="auto internal xref">5.3.1</a>.  <a href="#name-receipt-of-consistency" class="internal xref">Receipt of Consistency</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-log-length" class="internal xref">Log Length</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-header-parameters" class="internal xref">Header Parameters</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-choice-of-signature-algorit" class="internal xref">Choice of Signature Algorithms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-validity-period" class="internal xref">Validity Period</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-status-updates" class="internal xref">Status Updates</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-cose-header-parameter" class="internal xref">COSE Header Parameter</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-cose-verifiable-data-structur" class="internal xref">COSE Verifiable Data Structures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.1">
                    <p id="section-toc.1-1.8.2.2.2.1.1"><a href="#section-8.2.1" class="auto internal xref">8.2.1</a>.  <a href="#name-expert-review" class="internal xref">Expert Review</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-cose-verifiable-data-structure" class="internal xref">COSE Verifiable Data Structure Parameters</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.1">
                    <p id="section-toc.1-1.8.2.3.2.1.1"><a href="#section-8.3.1" class="auto internal xref">8.3.1</a>.  <a href="#name-expert-review-2" class="internal xref">Expert Review</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-implementation-status" class="internal xref">Implementation Status</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-transmute-prototype" class="internal xref">Transmute Prototype</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">COSE Receipts are signed proofs that include metadata about about certain states of a verifiable data structure (VDS) that are true when the COSE Receipt was issued.
COSE Receipts can include proves that a document is in a database (proof of inclusion), that a database is append only (proof of consistency), that a smaller set of statements are contained in a large set of statements (proof of disclosure, a special case of proof of inclusion), or proof that certain data is not yet present in a database (proofs of non inclusion).
Different VDS can produce different verifiable data structure proofs (VDP).
The combination of representations of various VDS and VDP can significantly increase burden for implementers and create interoperability challenges for transparency services.
This document describes how to convey VDS and associated VDP types in unified COSE envelopes.<a href="#section-1-1" class="pilcrow">¶</a></p>
<div id="requirements-notation">
<section id="section-1.1">
        <h3 id="name-requirements-notation">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-notation" class="section-name selfRef">Requirements Notation</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="param-list">
<section id="section-2">
      <h2 id="name-new-cose-header-parameters">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-new-cose-header-parameters" class="section-name selfRef">New COSE Header Parameters</a>
      </h2>
<p id="section-2-1">This document defines three new COSE header parameters, which are introduced up-front in this Section and elaborated on later in this document.<a href="#section-2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-2">
        <dt id="section-2-2.1">TBD_0 (requested assignment 394):</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.2">
          <p id="section-2-2.2.1">A COSE header parameter named <code>receipts</code> with a value type of array where the array contains one ore more COSE Receipts as specified in this document.<a href="#section-2-2.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.3">TBD_1 (requested assignment 395):</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.4">
          <p id="section-2-2.4.1">A COSE header parameter named <code>vds</code> with a value type of integer where the integer is a verifiable data structure (VDS) algorithm identifier as specified in this document. Correspondingly, this document introduces a new verifiable data structure algorithm identifier registry that registers the integers used as values for this COSE header parameter.<a href="#section-2-2.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.5">TBD_2 (requested assignment 396):</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.6">
          <p id="section-2-2.6.1">A COSE header parameter named <code>vdp</code> with a value type of map where the map contains verifiable data structure proofs (VDP) as specified in this this document. Correspondingly, this document introduces a new verifiable data structure proof registry that registers the integers that are used as labels in the map of this COSE header parameter.<a href="#section-2-2.6.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-2-3">The other codepoints in this document are assigned from the registries established in this draft, they are therefore not marked TBD.<a href="#section-2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-3">
      <h2 id="name-terminology">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<span class="break"></span><dl class="dlParallel" id="section-3-1">
        <dt id="section-3-1.1">CDDL:</dt>
        <dd style="margin-left: 1.5em" id="section-3-1.2">
          <p id="section-3-1.2.1">Concise Data Definition Language (CDDL) is defined in <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>.<a href="#section-3-1.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.3">EDN:</dt>
        <dd style="margin-left: 1.5em" id="section-3-1.4">
          <p id="section-3-1.4.1">CBOR Extended Diagnostic Notation (EDN) is defined in <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>, where it is referred to as "diagnostic notation", and is revised in <span>[<a href="#I-D.draft-ietf-cbor-edn-literals" class="cite xref">I-D.draft-ietf-cbor-edn-literals</a>]</span>.<a href="#section-3-1.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.5">Verifiable Data Structure (VDS):</dt>
        <dd style="margin-left: 1.5em" id="section-3-1.6">
          <p id="section-3-1.6.1">A data structure which supports one or more Verifiable Data Structure Parameters.
This property describes an algorithm used to maintain a verifiable data structure, for example a binary merkle tree algorithm.<a href="#section-3-1.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.7">Verifiable Data Structure Parameters (VDP):</dt>
        <dd style="margin-left: 1.5em" id="section-3-1.8">
          <p id="section-3-1.8.1">Parameters to a verifiable data structure that are used to prove properties, such as authentication, inclusion, consistency, and freshness.
Parameters can include multiple proofs of a given type, or multiple types of proof (inclusion and consistency).<a href="#section-3-1.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.9">Proof Type:</dt>
        <dd style="margin-left: 1.5em" id="section-3-1.10">
          <p id="section-3-1.10.1">A verifiable process, that proves properties of a Verifiable Data Structure.
For example, a VDS, such as a binary merkle tree, can support multiple proofs of type "inclusion" where each proof confirms that a given entry is included in a merkle root.<a href="#section-3-1.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.11">Proof Value:</dt>
        <dd style="margin-left: 1.5em" id="section-3-1.12">
          <p id="section-3-1.12.1">An encoding of a Proof Type in CBOR <span>[<a href="#RFC7049" class="cite xref">RFC7049</a>]</span>.<a href="#section-3-1.12.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.13">Entry:</dt>
        <dd style="margin-left: 1.5em" id="section-3-1.14">
          <p id="section-3-1.14.1">An entry in a verifiable data structure for which proofs can be derived.<a href="#section-3-1.14.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-1.15">Receipt:</dt>
        <dd style="margin-left: 1.5em" id="section-3-1.16">
          <p id="section-3-1.16.1">A COSE object, as defined in <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span>, containing the header parameters necessary to convey VDP for an associated VDS.<a href="#section-3-1.16.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-generic-verifiable-data-structures">
<section id="section-4">
      <h2 id="name-verifiable-data-structures-">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-verifiable-data-structures-" class="section-name selfRef">Verifiable Data Structures in CBOR</a>
      </h2>
<p id="section-4-1">This section describes representations of verifiable data structure proofs in <span>[<a href="#RFC7049" class="cite xref">RFC7049</a>]</span>.
For example, construction of a merkle tree leaf, or an inclusion proof from a leaf to a merkle root, might have several different representations, depending on the verifiable data structure used.
Differences in representations are necessary to support efficient verification, unique security or privacy properties, and for compatibility with specific implementations.
This document defines two extension points for enabling verifiable data structures with COSE and provides concrete examples for the structures and proofs defined in <span>[<a href="#RFC9162" class="cite xref">RFC9162</a>]</span>.
The design of these structures is influenced by the conventions established for COSE Keys.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="sec-cose-verifiable-data-structures">
<section id="section-4.1">
        <h3 id="name-structures">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-structures" class="section-name selfRef">Structures</a>
        </h3>
<p id="section-4.1-1">Similar to <a href="https://www.iana.org/assignments/cose/cose.xhtml#key-type">COSE Key Types</a>, different verifiable data structures support different algorithms.
As EC2 keys (1: 2) support both digital signature and key agreement algorithms, RFC9162_SHA256 (TBD_1 : 1) supports both inclusion and consistency proofs.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">This document establishes a registry of verifiable data structure algorithms, with the following initial contents:<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<span id="name-cose-verifiable-data-struct"></span><div id="cose-verifiable-data-structures">
<table class="left" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-cose-verifiable-data-struct" class="selfRef">COSE Verifiable Data Structures</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Reserved</td>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">RFC9162_SHA256</td>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">SHA256 Binary Merkle Tree</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC9162" class="cite xref">RFC9162</a>]</span>
</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="sec-cose-verifiable-data-structure-parameters">
<section id="section-4.2">
        <h3 id="name-parameters">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-parameters" class="section-name selfRef">Parameters</a>
        </h3>
<p id="section-4.2-1">Similar to <a href="https://www.iana.org/assignments/cose/cose.xhtml#key-type-parameters">COSE Key Type Parameters</a>, as EC2 keys (1: 2) keys require and give meaning to specific parameters, such as -1 (crv), -2 (x), -3 (y), -4 (d), RFC9162_SHA256 (TBD_1 : 1) supports both (-1) inclusion and (-2) consistency proofs.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">This document establishes a registry of verifiable data structure algorithms, with the following initial contents:<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<span id="name-cose-verifiable-data-structu"></span><div id="cose-verifiable-data-structures-parameters">
<table class="left" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-cose-verifiable-data-structu" class="selfRef">COSE Verifiable Data Structure Parameters</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Verifiable Data Structure</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Label</th>
              <th class="text-left" rowspan="1" colspan="1">CBOR Type</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">inclusion proofs</td>
              <td class="text-left" rowspan="1" colspan="1">-1</td>
              <td class="text-left" rowspan="1" colspan="1">array (of bstr)</td>
              <td class="text-left" rowspan="1" colspan="1">Proof of inclusion</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#sec-rfc9162-sha256-inclusion-proof" class="auto internal xref">Section 5.2</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">consistency proofs</td>
              <td class="text-left" rowspan="1" colspan="1">-2</td>
              <td class="text-left" rowspan="1" colspan="1">array (of bstr)</td>
              <td class="text-left" rowspan="1" colspan="1">Proof of append only property</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#sec-rfc9162-sha256-consistency-proof" class="auto internal xref">Section 5.3</a>
</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-4.2-4">Proof types are specific to their associated "verifiable data structure", for example, different Merkle trees might support different representations of "inclusion proof" or "consistency proof".
Implementers should not expect interoperability across "verifiable data structures", but they should expect conceptually similar properties across the different registered proof types.
For example, 2 different merkle tree based verifiable data structures might both support proofs of inclusion.
Security analysis <span class="bcp14">SHOULD</span> be conducted prior to migrating to new structures to ensure the new security and privacy assumptions are acceptable for the use case.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="receipt-spec">
<section id="section-4.3">
        <h3 id="name-usage">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-usage" class="section-name selfRef">Usage</a>
        </h3>
<p id="section-4.3-1">This document registered a new COSE Header Parameter <code>receipts</code> (394) to enable this Receipts to be conveyed in the protected and unprotected headers of COSE Objects.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">When the receipts header parameter is present, the associated verifiable data structure and verifiable data structure proofs <span class="bcp14">MUST</span> match entries present in the registries established in this specification.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">The following informative CDDL is provided:<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<span id="name-cddl-for-a-cose-sign1-with-"></span><div id="fig-receipts-cddl">
<figure id="figure-1">
          <div class="lang-cddl sourcecode" id="section-4.3-4.1">
<pre>
Receipt = #6.18(COSE_Sign1)

Protected_Header = {
  * cose-label =&gt; cose-value
}

Unprotected_Header = {
  &amp;(receipts: 394)  =&gt; [+ Receipt]
  * cose-label =&gt; cose-value
}

COSE_Sign1 = [
  protected   : bstr .cbor Protected_Header,
  unprotected : Unprotected_Header,
  payload     : bstr / nil,
  signature   : bstr
]
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-cddl-for-a-cose-sign1-with-" class="selfRef">CDDL for a COSE Sign1 with attached receipts</a>
          </figcaption></figure>
</div>
<p id="section-4.3-5">The following informative EDN is provided:<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<span id="name-a-cose-signature-with-multi"></span><div id="fig-receipts-edn">
<figure id="figure-2">
          <div class="breakable lang-cbor-diag sourcecode" id="section-4.3-6.1">
<pre>
/ cose-sign1 / 18([
  / protected   / &lt;&lt;{
    / key / 4 : "vCl7UcS0ZZY99VpRthDc-0iUjLdfLtnmFqLJ2-Tt8N4",
    / algorithm / 1 : -7,  # ES256
  }&gt;&gt;,
  / unprotected / {
    / receipts / 394 : {
      &lt;&lt;/ cose-sign1 / 18([
        / protected   / &lt;&lt;{
          / key / 4 : "mxA4KiOkQFZ-dkLebSo3mLOEPR7rN8XtxkJe45xuyJk",
          / algorithm / 1 : -7,  # ES256
          / vds       / 395 : 1, # RFC9162 SHA-256
        }&gt;&gt;,
        / unprotected / {
          / proofs / 396 : {
            / inclusion / -1 : [
              &lt;&lt;[
                / size / 9, / leaf / 8,
                / inclusion path /
                h'7558a95f...e02e35d6'
              ]&gt;&gt;
            ],
          },
        },
        / payload     / null,
        / signature   / h'02d227ed...ccd3774f'
      ])&gt;&gt;,
      &lt;&lt;/ cose-sign1 / 18([
        / protected   / &lt;&lt;{
          / key / 4 : "ajOkeBTJou_wPrlExLMw7L9OTCD5ZIOBYc-O6LESe9c",
          / algorithm / 1 : -7,  # ES256
          / vds       / 395 : 1, # RFC9162 SHA-256
        }&gt;&gt;,
        / unprotected / {
          / proofs / 396 : {
            / inclusion / -1 : [
              &lt;&lt;[
                / size / 6, / leaf / 5,
                / inclusion path /
                h'9352f974...4ffa7ce0',
                h'54806f32...f007ea06'
              ]&gt;&gt;
            ],
          },
        },
        / payload     / null,
        / signature   / h'36581f38...a5581960'
      ])&gt;&gt;
    },
  },
  / payload     / h'0167c57c...deeed6d4',
  / signature   / h'2544f2ed...5840893b'
])
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-a-cose-signature-with-multi" class="selfRef">A COSE Signature with multiple receipts</a>
          </figcaption></figure>
</div>
<div id="registration-requirements">
<section id="section-4.3.1">
          <h4 id="name-registration-requirements">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-registration-requirements" class="section-name selfRef">Registration Requirements</a>
          </h4>
<p id="section-4.3.1-1">Each specification <span class="bcp14">MUST</span> define how to encode the verifiable data structure identifier and its parameters (also called proof types) in CBOR.
Each specification <span class="bcp14">MUST</span> define how to produce and consume the supported proof types.
See <a href="#sec-rfc-9162-verifiable-data-structure-definition" class="auto internal xref">Section 5</a> as an example.<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-2">Where a specification supports a choice of hash algorithm, an IANA registration must be made for each individually supported algorithm.
For example, to provide for both SHA256 and SHA3_256 with <span>[<a href="#RFC9162" class="cite xref">RFC9162</a>]</span>,
both "RFC9162_SHA256" and "RFC9162_SHA3_256" require entries in the relevant IANA registries.<a href="#section-4.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-rfc-9162-verifiable-data-structure-definition">
<section id="section-5">
      <h2 id="name-rfc9162_sha256">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-rfc9162_sha256" class="section-name selfRef">RFC9162_SHA256</a>
      </h2>
<p id="section-5-1">This section defines how the data structures described in <span>[<a href="#RFC9162" class="cite xref">RFC9162</a>]</span> are mapped to the terminology defined in this document, using <span>[<a href="#RFC7049" class="cite xref">RFC7049</a>]</span> and <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="verifiable-data-structure">
<section id="section-5.1">
        <h3 id="name-verifiable-data-structure">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-verifiable-data-structure" class="section-name selfRef">Verifiable Data Structure</a>
        </h3>
<p id="section-5.1-1">The integer identifier for this Verifiable Data Structure is 1.
The string identifier for this Verifiable Data Structure is "RFC9162_SHA256".
See <a href="#cose-verifiable-data-structures" class="auto internal xref">Table 1</a>.
See <span>[<a href="#RFC9162" class="cite xref">RFC9162</a>]</span>, 2.1.1. Definition of the Merkle Tree, for a complete description of this verifiable data structure.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-rfc9162-sha256-inclusion-proof">
<section id="section-5.2">
        <h3 id="name-inclusion-proof">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-inclusion-proof" class="section-name selfRef">Inclusion Proof</a>
        </h3>
<p id="section-5.2-1">See <span>[<a href="#RFC9162" class="cite xref">RFC9162</a>]</span>, 2.1.3.1. Generating an Inclusion Proof, for a complete description of this verifiable data structure proof type.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">The CBOR representation of an inclusion proof for RFC9162_SHA256 is:<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<span id="name-cbor-encoded-rfc9162-inclus"></span><div id="rfc9162-sha256-cbor-inclusion-proof">
<figure id="figure-3">
          <div class="lang-cddl sourcecode" id="section-5.2-3.1">
<pre>
inclusion-proof = bstr .cbor [

    ; tree size at current merkle root
    tree-size: uint

    ; index of leaf in tree
    leaf-index: uint

    ; path from leaf to current merkle root
    inclusion-path: [ + bstr ]
]
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-cbor-encoded-rfc9162-inclus" class="selfRef">CBOR Encoded RFC9162 Inclusion Proof</a>
          </figcaption></figure>
</div>
<p id="section-5.2-4">The term <code>leaf-index</code> is used for alignment with the use established in <span>[<a href="#RFC9162" class="cite xref">RFC9162</a>]</span><a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">Note that <span>[<a href="#RFC9162" class="cite xref">RFC9162</a>]</span> defines that verification <span class="bcp14">MUST</span> fail if leaf-index is &gt;= tree-size, and inclusion proofs are defined only for leaf nodes.
The identifying index of a leaf node is relative to all nodes in the tree size for which the proof was obtained.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<div id="receipt-of-inclusion">
<section id="section-5.2.1">
          <h4 id="name-receipt-of-inclusion">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-receipt-of-inclusion" class="section-name selfRef">Receipt of Inclusion</a>
          </h4>
<p id="section-5.2.1-1">In a signed inclusion proof, the payload is the merkle tree root which corresponds to the log at size <code>tree-size</code>.
Specifications are encouraged to make payloads detached when possible, forcing validation-time comparison.
Profiles of proof signatures are encouraged to make additional protected header parameters mandatory, to ensure that claims are processed with their intended semantics.
One way to include this information in the COSE structure is use of the typ (type) Header Parameter, see <span>[<a href="#RFC9596" class="cite xref">RFC9596</a>]</span> and the similar guidance provided in <span>[<a href="#RFC9597" class="cite xref">RFC9597</a>]</span>.
The protected header for an RFC9162_SHA256 inclusion proof signature is:<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<span id="name-protected-header-for-a-rece"></span><div id="vds-in-inclusion-receipt-protected-header">
<figure id="figure-4">
            <div class="lang-cddl sourcecode" id="section-5.2.1-2.1">
<pre>
protected-header-map = {
  &amp;(alg: 1) =&gt; int
  &amp;(vds: 395) =&gt; int
  * cose-label =&gt; cose-value
}
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-protected-header-for-a-rece" class="selfRef">Protected Header for a Receipt of Inclusion</a>
            </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-5.2.1-3.1">
              <p id="section-5.2.1-3.1.1">alg (label: 1): <span class="bcp14">REQUIRED</span>. Signature algorithm identifier. Value type: int.<a href="#section-5.2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.2.1-3.2">
              <p id="section-5.2.1-3.2.1">vds (label: 395): <span class="bcp14">REQUIRED</span>. Verifiable data structure algorithm identifier. Value type: int.<a href="#section-5.2.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-5.2.1-4">The unprotected header for an RFC9162_SHA256 inclusion proof signature is:<a href="#section-5.2.1-4" class="pilcrow">¶</a></p>
<span id="name-a-verifiable-data-structure"></span><div id="vdp-in-unprotected-header">
<figure id="figure-5">
            <div class="lang-cddl sourcecode" id="section-5.2.1-5.1">
<pre>
inclusion-proofs = [ + inclusion-proof ]

verifiable-proofs = {
  &amp;(inclusion-proof: -1) =&gt; inclusion-proofs
}

unprotected-header-map = {
  &amp;(vdp: 396) =&gt; verifiable-proofs
  * cose-label =&gt; cose-value
}
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-a-verifiable-data-structure" class="selfRef">A Verifiable Data Structure Proofs in an Unprotected Header</a>
            </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-5.2.1-6.1">
              <p id="section-5.2.1-6.1.1">vdp (label: 396): <span class="bcp14">REQUIRED</span>. Verifiable data structure proofs. Value type: Map.<a href="#section-5.2.1-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.2.1-6.2">
              <p id="section-5.2.1-6.2.1">inclusion-proof (label: -1): <span class="bcp14">REQUIRED</span>. Inclusion proofs. Value type: Array of bstr.<a href="#section-5.2.1-6.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-5.2.1-7">The payload of an RFC9162_SHA256 inclusion proof signature is the Merkle tree hash as defined in <span>[<a href="#RFC9162" class="cite xref">RFC9162</a>]</span>.
The payload <span class="bcp14">SHOULD</span> be detached.
Detaching the payload forces verifiers to recompute the root from the inclusion proof, this protects against implementation errors where the signature is verified but the merkle root does not match the inclusion proof.
The EDN for a Receipt containing an inclusion proof for RFC9162_SHA256 is:<a href="#section-5.2.1-7" class="pilcrow">¶</a></p>
<span id="name-receipt-of-inclusion-2"></span><div id="rfc9162_sha256_inclusion_receipt">
<figure id="figure-6">
            <div class="lang-cbor-diag sourcecode" id="section-5.2.1-8.1">
<pre>
/ cose-sign1 / 18([
  / protected   / &lt;&lt;{
    / algorithm / 1 : -7,  # ES256
    / vds       / 395 : 1, # RFC9162 SHA-256
  }&gt;&gt;,
  / unprotected / {
    / proofs / 396 : {
      / inclusion / -1 : [
        &lt;&lt;[
          / size / 20, / leaf / 17,
          / inclusion path /
          h'fc9f050f...221c92cb',
          h'bd0136ad...6b28cf21',
          h'd68af9d6...93b1632b'
        ]&gt;&gt;
      ],
    },
  },
  / payload     / null,
  / signature   / h'de24f0cc...9a5ade89'
])
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-receipt-of-inclusion-2" class="selfRef">Receipt of Inclusion</a>
            </figcaption></figure>
</div>
<p id="section-5.2.1-9">The VDS in the protected header is necessary to understand the inclusion proof structure in the unprotected header.<a href="#section-5.2.1-9" class="pilcrow">¶</a></p>
<p id="section-5.2.1-10">The inclusion proof and signature are verified in order.
First the verifiers applies the inclusion proof to a possible entry (set member) bytes.
If this process fails, the inclusion proof may have been tampered with.
If this process succeeds, the result is a merkle root, which in the attached as the COSE Sign1 payload.
Second the verifier checks the signature of the COSE Sign1.
If the resulting signature verifies, the Receipt has proved inclusion of the entry in the verifiable data structure.
If the resulting signature does not verify, the signature may have been tampered with.
It is recommended that implementations return a single boolean result for Receipt verification operations, to reduce the chance of accepting a valid signature over an invalid inclusion proof.<a href="#section-5.2.1-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-rfc9162-sha256-consistency-proof">
<section id="section-5.3">
        <h3 id="name-consistency-proof">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-consistency-proof" class="section-name selfRef">Consistency Proof</a>
        </h3>
<p id="section-5.3-1">See <span>[<a href="#RFC9162" class="cite xref">RFC9162</a>]</span>, 2.1.4.1. Generating a Consistency Proof, for a complete description of this verifiable data structure proof type.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">The cbor representation of a consistency proof for RFC9162_SHA256 is:<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<span id="name-cbor-encoded-rfc9162-consis"></span><div id="rfc9162_sha256_consistency_proof">
<figure id="figure-7">
          <div class="lang-cddl sourcecode" id="section-5.3-3.1">
<pre>
consistency-proof =  bstr .cbor [

    ; older merkle root tree size
    tree-size-1: uint

    ; newer merkle root tree size
    tree-size-2: uint

    ; path from older merkle root to newer merkle root.
    consistency-path: [ + bstr ]

]
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-cbor-encoded-rfc9162-consis" class="selfRef">CBOR Encoded RFC9162 Consistency Proof</a>
          </figcaption></figure>
</div>
<div id="receipt-of-consistency">
<section id="section-5.3.1">
          <h4 id="name-receipt-of-consistency">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-receipt-of-consistency" class="section-name selfRef">Receipt of Consistency</a>
          </h4>
<p id="section-5.3.1-1">In a signed consistency proof, the newer merkle tree root (proven to be consistent with an older merkle tree root) is an attached payload and corresponds to the log at size tree-size-2.<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
<p id="section-5.3.1-2">The protected header for an RFC9162_SHA256 consistency proof signature is:<a href="#section-5.3.1-2" class="pilcrow">¶</a></p>
<span id="name-protected-header-for-a-recei"></span><div id="vds-in-consistency-receipt-protected-header">
<figure id="figure-8">
            <div class="lang-cddl sourcecode" id="section-5.3.1-3.1">
<pre>
protected-header-map = {
  &amp;(alg: 1) =&gt; int
  &amp;(vds: 395) =&gt; int
  * cose-label =&gt; cose-value
}
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-protected-header-for-a-recei" class="selfRef">Protected Header for a Receipt of Consistency</a>
            </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="section-5.3.1-4.1">
              <p id="section-5.3.1-4.1.1">alg (label: 1): <span class="bcp14">REQUIRED</span>. Signature algorithm identifier. Value type: int.<a href="#section-5.3.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.3.1-4.2">
              <p id="section-5.3.1-4.2.1">vds (label: TBD_1): <span class="bcp14">REQUIRED</span>. Verifiable data structure algorithm identifier. Value type: int.<a href="#section-5.3.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-5.3.1-5">The unprotected header for an RFC9162_SHA256 consistency proof signature is:<a href="#section-5.3.1-5" class="pilcrow">¶</a></p>
<div class="lang-cddl sourcecode" id="section-5.3.1-6">
<pre>
consistency-proofs = [ + consistency-proof ]

verifiable-proofs = {
  &amp;(consistency-proof: -2) =&gt; consistency-proofs
}

unprotected-header-map = {
  &amp;(vdp: 396) =&gt; verifiable-proofs
  * cose-label =&gt; cose-value
}
</pre><a href="#section-5.3.1-6" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-5.3.1-7.1">
              <p id="section-5.3.1-7.1.1">vdp (label: 396): <span class="bcp14">REQUIRED</span>. Verifiable data structure proofs. Value type: Map.<a href="#section-5.3.1-7.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.3.1-7.2">
              <p id="section-5.3.1-7.2.1">consistency-proof (label: -2): <span class="bcp14">REQUIRED</span>. Consistency proofs. Value type: Array of bstr.<a href="#section-5.3.1-7.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-5.3.1-8">The payload of an RFC9162_SHA256 consistency proof signature is:
The newer Merkle tree hash as defined in <span>[<a href="#RFC9162" class="cite xref">RFC9162</a>]</span>.
The payload <span class="bcp14">SHOULD</span> be detached.
Detaching the payload forces verifiers to recompute the root from the consistency proof, this protects against implementation errors where the signature is verified but the merkle root does not match the proof.<a href="#section-5.3.1-8" class="pilcrow">¶</a></p>
<p id="section-5.3.1-9">The EDN for a Receipt containing a consistency proof for RFC9162_SHA256 is:<a href="#section-5.3.1-9" class="pilcrow">¶</a></p>
<span id="name-example-consistency-receipt"></span><div id="rfc9162_sha256_consistency_receipt">
<figure id="figure-9">
            <div class="lang-cbor-diag sourcecode" id="section-5.3.1-10.1">
<pre>
/ cose-sign1 / 18([
  / protected   / &lt;&lt;{
    / algorithm / 1 : -7,  # ES256
    / vds       / 395 : 1, # RFC9162 SHA-256
  }&gt;&gt;,
  / unprotected / {
    / proofs / 396 : {
      / consistency / -2 : [
        &lt;&lt;[
          / old / 20, / new / 104,
          / consistency path /
          h'e5b3e764...c4a813bc',
          h'87e8a084...4f529f69',
          h'f712f76d...92a0ff36',
          h'd68af9d6...93b1632b',
          h'249efab6...b7614ccd',
          h'85dd6293...38914dc1'
        ]&gt;&gt;
      ],
    },
  },
  / payload     / null,
  / signature   / h'94469f73...52de67a1'
])
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-example-consistency-receipt" class="selfRef">Example consistency receipt</a>
            </figcaption></figure>
</div>
<p id="section-5.3.1-11">The VDS in the protected header is necessary to understand the consistency proof structure in the unprotected header.<a href="#section-5.3.1-11" class="pilcrow">¶</a></p>
<p id="section-5.3.1-12">The signature and consistency proof are verified in order.<a href="#section-5.3.1-12" class="pilcrow">¶</a></p>
<p id="section-5.3.1-13">First the verifier checks the signature on the COSE Sign1.
If the verification fails, the consistency proof is not checked.
Second the consistency proof is checked by applying a previous inclusion proof, to the consistency proof.
If the verification fails, the append only property of the verifiable data structure is not assured.
This approach is specific to RFC9162_SHA256, different verifiable data structures may not support consistency proofs.
It is recommended that implementations return a single boolean result for Receipt verification operations, to reduce the chance of accepting a valid signature over an invalid consistency proof.<a href="#section-5.3.1-13" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-6">
      <h2 id="name-privacy-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-6-1">See the privacy considerations section of:<a href="#section-6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-2.1">
          <p id="section-6-2.1.1"><span>[<a href="#RFC9162" class="cite xref">RFC9162</a>]</span><a href="#section-6-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-2.2">
          <p id="section-6-2.2.1"><span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span><a href="#section-6-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="log-length">
<section id="section-6.1">
        <h3 id="name-log-length">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-log-length" class="section-name selfRef">Log Length</a>
        </h3>
<p id="section-6.1-1">Some structures and proofs leak the size of the log at the time of inclusion.
In the case that a log only stores certain kinds of information, this can reveal details that could impact reputation.
For example, if a transparency log only stored breach notices, a receipt for a breach notice would reveal the number of previous breaches at the time the notice was made transparent.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="header-parameters">
<section id="section-6.2">
        <h3 id="name-header-parameters">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-header-parameters" class="section-name selfRef">Header Parameters</a>
        </h3>
<p id="section-6.2-1">Additional header parameters can reveal information about the transparency service or its log entries.
A privacy analysis <span class="bcp14">MUST</span> be performed for all mandatory fields in profiles based on this specification.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">See the security considerations section of:<a href="#section-7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-2.1">
          <p id="section-7-2.1.1"><span>[<a href="#RFC9162" class="cite xref">RFC9162</a>]</span><a href="#section-7-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-2.2">
          <p id="section-7-2.2.1"><span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span><a href="#section-7-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="choice-of-signature-algorithms">
<section id="section-7.1">
        <h3 id="name-choice-of-signature-algorit">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-choice-of-signature-algorit" class="section-name selfRef">Choice of Signature Algorithms</a>
        </h3>
<p id="section-7.1-1">A security analysis <span class="bcp14">MUST</span> be performed to ensure that the digital signature algorithm <code>alg</code> has the appropriate strength to secure receipts.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">It is recommended to select signature algorithms that share cryptographic components with the verifiable data structure used, for example:
Both RFC9162_SHA256 and ES256 depend on the sha-256 hash function.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="validity-period">
<section id="section-7.2">
        <h3 id="name-validity-period">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-validity-period" class="section-name selfRef">Validity Period</a>
        </h3>
<p id="section-7.2-1">In some cases, receipts <span class="bcp14">MAY</span> include strict validity periods, for example, activation not too far in the future, or expiration, not too far in the past.
See the <code>iat</code>, <code>nbf</code>, and <code>exp</code> claims in <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>, for one way to accomplish this.
The details of expressing validity periods are out of scope for this document.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="status-updates">
<section id="section-7.3">
        <h3 id="name-status-updates">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-status-updates" class="section-name selfRef">Status Updates</a>
        </h3>
<p id="section-7.3-1">In some cases, receipts should be "revocable" or "suspendible", after being issued, regardless of their validity period.
The details of expressing statuses are out of scope for this document.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="cose-header-parameter">
<section id="section-8.1">
        <h3 id="name-cose-header-parameter">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-cose-header-parameter" class="section-name selfRef">COSE Header Parameter</a>
        </h3>
<p id="section-8.1-1">IANA is requested to add the COSE header parameters defined in <a href="#param-list" class="auto internal xref">Section 2</a>, as listed in <a href="#iana-header-params" class="auto internal xref">Table 3</a>, to the "COSE Header Parameters" registry <span>[<a href="#IANA.cose_header-parameters" class="cite xref">IANA.cose_header-parameters</a>]</span> in the 'Integer values from 256 to 65535' range ('Specification Required' Registration Procedure).
All new entries use https://www.iana.org/assignments/cose/cose.xhtml#header-parameters as the value for the "Value Registry" column.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<span id="name-newly-registered-cose-heade"></span><div id="iana-header-params">
<table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-newly-registered-cose-heade" class="selfRef">Newly registered COSE Header Parameters</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Label</th>
              <th class="text-left" rowspan="1" colspan="1">Value Type</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>receipts</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TBD_0 (requested assignment: 394)</td>
              <td class="text-left" rowspan="1" colspan="1">array</td>
              <td class="text-left" rowspan="1" colspan="1">Priority ordered sequence of CBOR encoded Receipts</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis, <a href="#param-list" class="auto internal xref">Section 2</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>vds</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TBD_1 (requested assignment: 395)</td>
              <td class="text-left" rowspan="1" colspan="1">int</td>
              <td class="text-left" rowspan="1" colspan="1">Algorithm identifier for verifiable data structure, used to produce verifiable data structure proofs</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis, <a href="#param-list" class="auto internal xref">Section 2</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">
                <code>vdp</code>
</td>
              <td class="text-left" rowspan="1" colspan="1">TBD_2 (requested assignment: 396)</td>
              <td class="text-left" rowspan="1" colspan="1">map</td>
              <td class="text-left" rowspan="1" colspan="1">Location for verifiable data structure proofs in COSE Header Parameters</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis, <a href="#param-list" class="auto internal xref">Section 2</a>
</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="verifiable-data-structure-registry">
<section id="section-8.2">
        <h3 id="name-cose-verifiable-data-structur">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-cose-verifiable-data-structur" class="section-name selfRef">COSE Verifiable Data Structures</a>
        </h3>
<p id="section-8.2-1">IANA will be asked to establish a registry of verifiable data structure identifiers, named "COSE Verifiable Data Structures" to be administered under a Specification Required policy <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">Template:<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2-3.1">
            <p id="section-8.2-3.1.1">Name: The name of the verifiable data structure<a href="#section-8.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.2-3.2">
            <p id="section-8.2-3.2.1">Value: The identifier for the verifiable data structure<a href="#section-8.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.2-3.3">
            <p id="section-8.2-3.3.1">Description: A brief description of the verifiable data structure<a href="#section-8.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.2-3.4">
            <p id="section-8.2-3.4.1">Reference: Where the verifiable data structure is defined<a href="#section-8.2-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.2-4">Initial contents: Provided in <a href="#cose-verifiable-data-structures" class="auto internal xref">Table 1</a><a href="#section-8.2-4" class="pilcrow">¶</a></p>
<div id="expert-review">
<section id="section-8.2.1">
          <h4 id="name-expert-review">
<a href="#section-8.2.1" class="section-number selfRef">8.2.1. </a><a href="#name-expert-review" class="section-name selfRef">Expert Review</a>
          </h4>
<p id="section-8.2.1-1">This IANA registries is established under a Specification Required policy.<a href="#section-8.2.1-1" class="pilcrow">¶</a></p>
<p id="section-8.2.1-2">Expert reviewers should take into consideration the following points:<a href="#section-8.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2.1-3.1">
              <p id="section-8.2.1-3.1.1">Experts are advised to assign the next available positive integer for verifiable data structures.<a href="#section-8.2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.1-3.2">
              <p id="section-8.2.1-3.2.1">Point squatting should be discouraged.
Reviewers are encouraged to get sufficient information for registration requests to ensure that the usage is not going to duplicate one that is already registered, and that the point is likely to be used in deployments.<a href="#section-8.2.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.1-3.3">
              <p id="section-8.2.1-3.3.1">Specifications are required for all point assignments.
Early Allocation is permissible, see Section 2 of <span>[<a href="#RFC7120" class="cite xref">RFC7120</a>]</span>.
Provisional assignments to expired drafts <span class="bcp14">MUST</span> be removed from the registry.<a href="#section-8.2.1-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.1-3.4">
              <p id="section-8.2.1-3.4.1">Points assigned in this registry <span class="bcp14">MUST</span> have references that match the COSE Verifiable Data Structure Parameters registry.
It is not permissible to assign points in this registry, for which no Verifiable Data Structure Parameters entries exist.<a href="#section-8.2.1-3.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="verifiable-data-structure-parameters-registry">
<section id="section-8.3">
        <h3 id="name-cose-verifiable-data-structure">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-cose-verifiable-data-structure" class="section-name selfRef">COSE Verifiable Data Structure Parameters</a>
        </h3>
<p id="section-8.3-1">IANA will be asked to establish a registry of verifiable data structure parameters, named "COSE Verifiable Data Structure Parameters" to be administered under a Specification Required policy <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3-2">Template:<a href="#section-8.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-3.1">
            <p id="section-8.3-3.1.1">Verifiable Data Structure: The identifier for the verifiable data structure<a href="#section-8.3-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.3-3.2">
            <p id="section-8.3-3.2.1">Name: The name of the proof type<a href="#section-8.3-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.3-3.3">
            <p id="section-8.3-3.3.1">Label: The integer of the proof type<a href="#section-8.3-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.3-3.4">
            <p id="section-8.3-3.4.1">CBOR Type: The cbor data type of the proof<a href="#section-8.3-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.3-3.5">
            <p id="section-8.3-3.5.1">Description: The description of the proof type<a href="#section-8.3-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.3-3.6">
            <p id="section-8.3-3.6.1">Reference: Where the proof type is defined<a href="#section-8.3-3.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.3-4">Initial contents: Provided in <a href="#cose-verifiable-data-structures-parameters" class="auto internal xref">Table 2</a><a href="#section-8.3-4" class="pilcrow">¶</a></p>
<div id="expert-review-1">
<section id="section-8.3.1">
          <h4 id="name-expert-review-2">
<a href="#section-8.3.1" class="section-number selfRef">8.3.1. </a><a href="#name-expert-review-2" class="section-name selfRef">Expert Review</a>
          </h4>
<p id="section-8.3.1-1">This IANA registries is established under a Specification Required policy.<a href="#section-8.3.1-1" class="pilcrow">¶</a></p>
<p id="section-8.3.1-2">Expert reviewers should take into consideration the following points:<a href="#section-8.3.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3.1-3.1">
              <p id="section-8.3.1-3.1.1">Experts should assign the next available negative integer for proof types.<a href="#section-8.3.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.3.1-3.2">
              <p id="section-8.3.1-3.2.1">Point squatting should be discouraged.
Reviewers are encouraged to get sufficient information for registration requests to ensure that the usage is not going to duplicate one that is already registered, and that the point is likely to be used in deployments.<a href="#section-8.3.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.3.1-3.3">
              <p id="section-8.3.1-3.3.1">Specifications are required for all point assignments.
Early Allocation is permissible, see Section 2 of <span>[<a href="#RFC7120" class="cite xref">RFC7120</a>]</span>.
Provisional assignments to expired drafts <span class="bcp14">MUST</span> be removed from the registry.<a href="#section-8.3.1-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.3.1-3.4">
              <p id="section-8.3.1-3.4.1">Points assigned in this registry <span class="bcp14">MUST</span> have references that match the COSE Verifiable Data Structures registry.
It is not permissible to assign points in this registry, for which no Verifiable Data Structure entry exists.<a href="#section-8.3.1-3.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="Acknowledgements">
<section id="section-9">
      <h2 id="name-acknowledgements">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-9-1">We would like to thank
Maik Riechert,
Jon Geater,
Michael B. Jones,
Mike Prorock,
Ilari Liusvaara,
for their contributions (some of which substantial) to this draft and to the initial set of implementations.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="IANA.cose_header-parameters">[IANA.cose_header-parameters]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Header Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose">https://www.iana.org/assignments/cose</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7049">[RFC7049]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">RFC 7049</span>, <span class="seriesInfo">DOI 10.17487/RFC7049</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7049">https://www.rfc-editor.org/rfc/rfc7049</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9053">[RFC9053]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Initial Algorithms"</span>, <span class="seriesInfo">RFC 9053</span>, <span class="seriesInfo">DOI 10.17487/RFC9053</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9053">https://www.rfc-editor.org/rfc/rfc9053</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9162">[RFC9162]</dt>
        <dd>
<span class="refAuthor">Laurie, B.</span>, <span class="refAuthor">Messeri, E.</span>, and <span class="refAuthor">R. Stradling</span>, <span class="refTitle">"Certificate Transparency Version 2.0"</span>, <span class="seriesInfo">RFC 9162</span>, <span class="seriesInfo">DOI 10.17487/RFC9162</span>, <time datetime="2021-12" class="refDate">December 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9162">https://www.rfc-editor.org/rfc/rfc9162</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9596">[RFC9596]</dt>
        <dd>
<span class="refAuthor">Jones, M.B.</span> and <span class="refAuthor">O. Steele</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE) "typ" (type) Header Parameter"</span>, <span class="seriesInfo">RFC 9596</span>, <span class="seriesInfo">DOI 10.17487/RFC9596</span>, <time datetime="2024-06" class="refDate">June 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9596">https://www.rfc-editor.org/rfc/rfc9596</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9597">[RFC9597]</dt>
      <dd>
<span class="refAuthor">Looker, T.</span> and <span class="refAuthor">M.B. Jones</span>, <span class="refTitle">"CBOR Web Token (CWT) Claims in COSE Headers"</span>, <span class="seriesInfo">RFC 9597</span>, <span class="seriesInfo">DOI 10.17487/RFC9597</span>, <time datetime="2024-06" class="refDate">June 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9597">https://www.rfc-editor.org/rfc/rfc9597</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="BCP205">[BCP205]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span> and <span class="refAuthor">A. Farrel</span>, <span class="refTitle">"Improving Awareness of Running Code: The Implementation Status Section"</span>, <span class="seriesInfo">BCP 205</span>, <span class="seriesInfo">RFC 7942</span>, <span class="seriesInfo">DOI 10.17487/RFC7942</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7942">https://www.rfc-editor.org/rfc/rfc7942</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.draft-ietf-cbor-edn-literals">[I-D.draft-ietf-cbor-edn-literals]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"CBOR Extended Diagnostic Notation (EDN)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cbor-edn-literals-16</span>, <time datetime="2025-01-08" class="refDate">8 January 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cbor-edn-literals-16">https://datatracker.ietf.org/doc/html/draft-ietf-cbor-edn-literals-16</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7120">[RFC7120]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refTitle">"Early IANA Allocation of Standards Track Code Points"</span>, <span class="seriesInfo">BCP 100</span>, <span class="seriesInfo">RFC 7120</span>, <span class="seriesInfo">DOI 10.17487/RFC7120</span>, <time datetime="2014-01" class="refDate">January 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7120">https://www.rfc-editor.org/rfc/rfc7120</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8126">https://www.rfc-editor.org/rfc/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8392">https://www.rfc-editor.org/rfc/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8610">https://www.rfc-editor.org/rfc/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9052">[RFC9052]</dt>
      <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9052</span>, <span class="seriesInfo">DOI 10.17487/RFC9052</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9052">https://www.rfc-editor.org/rfc/rfc9052</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="implementation-status">
<section id="appendix-A">
      <h2 id="name-implementation-status">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
      </h2>
<p id="appendix-A-1">Note to RFC Editor: Please remove this section as well as references to <span>[<a href="#BCP205" class="cite xref">BCP205</a>]</span> before AUTH48.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">This section records the status of known implementations of the protocol defined by this specification at the time of posting of this Internet-Draft, and is based on a proposal described in <span>[<a href="#BCP205" class="cite xref">BCP205</a>]</span>.
The description of implementations in this section is intended to assist the IETF in its decision processes in progressing drafts to RFCs.
Please note that the listing of any individual implementation here does not imply endorsement by the IETF.
Furthermore, no effort has been spent to verify the information presented here that was supplied by IETF contributors.
This is not intended as, and must not be construed to be, a catalog of available implementations or their features.
Readers are advised to note that other implementations may exist.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<p id="appendix-A-3">According to <span>[<a href="#BCP205" class="cite xref">BCP205</a>]</span>, "this will allow reviewers and working groups to assign due consideration to documents that have the benefit of running code, which may serve as evidence of valuable experimentation and feedback that have made the implemented protocols more mature.
It is up to the individual working groups to use this information as they see fit".<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<div id="transmute-prototype">
<section id="appendix-A.1">
        <h3 id="name-transmute-prototype">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-transmute-prototype" class="section-name selfRef">Transmute Prototype</a>
        </h3>
<p id="appendix-A.1-1">An open-source implementation was initiated and is maintained by the Transmute Industries Inc. - Transmute.
An application demonstrating the concepts is available at <a href="https://github.com/transmute-industries/cose?tab=readme-ov-file#transparent-statement">COSE SCITT Receipts</a><a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2">Implementation URL: https://github.com/transmute-industries/cose
Maturity: The code's level of maturity is considered to be "prototype".
Coverage and Version Compatibility: The current version ('main') implements the verifiable data structure algorithm, inclusion proof and consistency proof concepts of this draft.
License: The project and all corresponding code and data maintained on GitHub are provided under the Apache License, version 2.
Contact: Orie Steele (orie@transmute.industries)<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Orie Steele</span></div>
<div dir="auto" class="left"><span class="org">Transmute</span></div>
<div dir="auto" class="left"><span class="country-name">United States</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:orie@transmute.industries" class="email">orie@transmute.industries</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Henk Birkholz</span></div>
<div dir="auto" class="left"><span class="org">Fraunhofer SIT</span></div>
<div dir="auto" class="left"><span class="street-address">Rheinstrasse 75</span></div>
<div dir="auto" class="left">
<span class="postal-code">64295</span> <span class="locality">Darmstadt</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:henk.birkholz@ietf.contact" class="email">henk.birkholz@ietf.contact</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Antoine Delignat-Lavaud</span></div>
<div dir="auto" class="left"><span class="org">Microsoft</span></div>
<div dir="auto" class="left"><span class="country-name">United Kingdom</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:antdl@microsoft.com" class="email">antdl@microsoft.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Cedric Fournet</span></div>
<div dir="auto" class="left"><span class="org">Microsoft</span></div>
<div dir="auto" class="left"><span class="country-name">United Kingdom</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:fournet@microsoft.com" class="email">fournet@microsoft.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
